# Environment Variables - AntimalwareHispan Platform
# Copiar este archivo a .env y configurar valores reales

# ===== APPLICATION =====
APP_NAME=AntimalwareHispan Platform
APP_VERSION=0.1.0-mvp
ENVIRONMENT=development  # development | staging | production
DEBUG=true
LOG_LEVEL=INFO

# ===== DATABASE =====
DATABASE_URL=postgresql://antimalware:changeme_in_production@localhost:5432/antimalware_db
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_ECHO=false  # Set true para ver SQL queries en logs (solo dev)

# ===== REDIS =====
REDIS_URL=redis://localhost:6379/0
REDIS_MAX_CONNECTIONS=50

# ===== CELERY =====
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_ALWAYS_EAGER=false  # Set true para testing s√≠ncrono

# ===== MEILISEARCH =====
MEILISEARCH_URL=http://localhost:7700
MEILISEARCH_API_KEY=changeme_master_key_production

# ===== JWT AUTHENTICATION =====
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=<GENERATE_WITH_OPENSSL>
JWT_ALGORITHM=HS256  # HS256 for MVP, RS256 for production
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# ===== SECURITY =====
# Generate with: openssl rand -hex 32
SECRET_KEY=<GENERATE_WITH_OPENSSL>
ALLOWED_HOSTS=localhost,127.0.0.1
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# ===== VIRUSTOTAL =====
VIRUSTOTAL_API_KEY=<YOUR_VT_API_KEY>
VIRUSTOTAL_API_URL=https://www.virustotal.com/api/v3
VIRUSTOTAL_RATE_LIMIT=4  # requests per minute (free tier)

# ===== CUCKOO CAPE (Sandbox) =====
CUCKOO_API_URL=http://localhost:8090
CUCKOO_API_TOKEN=  # Opcional si Cuckoo tiene auth
CUCKOO_TIMEOUT=600  # segundos (10 min)

# ===== STORAGE =====
STORAGE_BACKEND=local  # local | s3 | gcs
LOCAL_STORAGE_PATH=./storage

# S3 Configuration (if STORAGE_BACKEND=s3)
S3_BUCKET=antimalware-samples-production
S3_REGION=eu-west-1
AWS_ACCESS_KEY_ID=<AWS_KEY>
AWS_SECRET_ACCESS_KEY=<AWS_SECRET>
S3_ENDPOINT_URL=  # Para MinIO self-hosted: http://localhost:9000

# ===== RATE LIMITING =====
RATE_LIMIT_ENABLED=true
RATE_LIMIT_STORAGE_URL=redis://localhost:6379/3

# ===== YARA =====
YARA_RULES_PATH=./yara-rules
YARA_RULES_AUTO_UPDATE=true

# ===== AI / OpenAI (para v1) =====
OPENAI_API_KEY=<YOUR_OPENAI_KEY>
OPENAI_MODEL=gpt-4o
OPENAI_MAX_TOKENS=4000
AI_ENABLED=false  # Enable en v1

# ===== MONITORING =====
SENTRY_DSN=  # https://sentry.io DSN
PROMETHEUS_ENABLED=true
METRICS_PORT=9090

# ===== QUOTAS (Default per tenant) =====
DEFAULT_MAX_SAMPLES_PER_MONTH=1000
DEFAULT_MAX_STORAGE_GB=100
DEFAULT_MAX_CONCURRENT_ANALYSES=3
DEFAULT_API_RATE_LIMIT_PER_MINUTE=60
